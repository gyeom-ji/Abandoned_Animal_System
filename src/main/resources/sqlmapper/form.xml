<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.FormMapper">
    <resultMap id="result" type="DB.dto.FormDTO">
        <result property="form_pk" column="form_pk"/>
        <result property="abandoned_notice_pk" column="abandoned_notice_pk"/>
        <result property="roll_pk" column="roll_pk"/>
        <result property="form_type" column="form_type"/>
        <result property="form_approval" column="form_approval"/>
    </resultMap>
    <resultMap id="abandoned_result" type="DB.dto.Abandoned_noticeDTO">
        <result property="abandoned_notice_pk" column="abandoned_notice_pk"/>
        <result property="shelter_list_pk" column="shelter_list_pk"/>
        <result property="abandoned_num" column="abandoned_num"/>
        <result property="abandoned_receipt_date" column="abandoned_receipt_date"/>
        <result property="abandoned_place" column="abandoned_place"/>
        <result property="abandoned_period" column="abandoned_period"/>
    </resultMap>
    <resultMap id="roll_result" type="DB.dto.RollDTO">
        <result property="roll_pk" column="roll_pk"/>
        <result property="roll_id" column="roll_id"/>
        <result property="roll_pw" column="roll_pw"/>
        <result property="roll_name" column="roll_name"/>
        <result property="roll_phone" column="roll_phone"/>
        <result property="roll_type" column="roll_type"/>
    </resultMap>
    <resultMap id="shelter_result" type="DB.dto.Shelter_listDTO">
        <result property="shelter_list_pk" column="shelter_list_pk"/>
        <result property="shelter_name" column="shelter_name"/>
        <result property="shelter_phone" column="shelter_phone"/>
        <result property="shelter_county" column="shelter_county"/>
        <result property="shelter_type" column="shelter_type"/>
        <result property="shelter_open_time" column="shelter_open_time"/>
        <result property="shelter_close_time" column="shelter_close_time"/>
        <result property="shelter_city" column="shelter_city"/>
    </resultMap>
    <resultMap id="animal_result" type="DB.dto.AnimalDTO">
        <result property="animal_pk" column="animal_pk"/>
        <result property="animal_kind" column="animal_kind"/>
        <result property="animal_sex" column="animal_sex"/>
        <result property="animal_age" column="animal_age"/>
        <result property="animal_color" column="animal_color"/>
        <result property="animal_feature" column="animal_feature"/>
        <result property="animal_breed" column="animal_breed"/>
        <result property="animal_neuter" column="animal_neuter"/>
        <result property="animal_img" column="animal_img"/>
    </resultMap>

    <select id="FindByMember" resultMap="result,roll_result" parameterType="String" >
        SELECT *
        FROM FORM as f
                 JOIN roll as r
                      ON f.roll_pk = r.roll_pk
        WHERE roll_id = #{roll_id}

    </select>

    <select id="FindByStaff" resultMap="result,abandoned_result,shelter_result" parameterType="long" >
        SELECT *
        FROM FORM as f
                 JOIN abandoned_notice as a
                      ON f.abandoned_notice_pk = a.abandoned_notice_pk
                 JOIN shelter_list as s
                      ON s.shelter_list_pk = a.shelter_list_pk
        WHERE s.shelter_name = #{shelter_list_name}


    </select>

    <update id="UpdateForm" parameterType="DB.dto.FormDTO">
        UPDATE FORM
        SET form_approval = #{form_approval}
        WHERE form_pk = #{form_pk}
    </update>

    <update id="UpdateType" parameterType="DB.dto.FormDTO">
        UPDATE FORM
        SET form_type = #{form_type}
        WHERE form_pk = #{form_pk}
    </update>

    <insert id="InsertForm" parameterType="DB.dto.FormDTO">
        INSERT INTO FORM(roll_pk, abandoned_notice_pk, form_type, form_approval)
        VALUES (#{roll_pk}, #{abandoned_notice_pk}, #{form_type}, #{form_approval})
    </insert>

    <delete id="RemoveForm" parameterType="long" >
        DELETE FROM FORM
        WHERE form_pk = #{form_pk}
    </delete>

    <select id="FindByForm_id" resultMap="result" >
        SELECT *
        FROM FORM
        <where>
            form_pk = #{form_pk}
        </where>
    </select>
</mapper>
